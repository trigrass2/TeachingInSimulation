<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cas.sim.tis.mapper.LibraryPublishMapper">
	<resultMap id="BaseResultMap" type="com.cas.sim.tis.entity.LibraryPublish">
		<id column="ID" jdbcType="INTEGER" property="id" />
		<result column="LID" jdbcType="INTEGER" property="libraryId" />
		<result column="CID" jdbcType="INTEGER" property="classId" />
		<result column="TYPE" jdbcType="INTEGER" property="type" />
		<result column="AVERAGE" jdbcType="FLOAT" property="average" />
		<result column="TIME" jdbcType="INTEGER" property="time" />
		<result column="CREATOR" jdbcType="VARCHAR" property="creator" />
		<result column="CREATE_DATE" jdbcType="VARCHAR" property="createDate" />
	</resultMap>
	<resultMap id="ForTeacherMap" type="com.cas.sim.tis.vo.LibraryPublishForTeacher">
		<id column="ID" jdbcType="INTEGER" property="id" />
		<result column="NAME" jdbcType="VARCHAR" property="name" />
		<result column="AVERAGE" jdbcType="FLOAT" property="average" />
		<result column="TIME" jdbcType="INTEGER" property="time" />
	</resultMap>
	<resultMap id="ForStudentMap" type="com.cas.sim.tis.vo.LibraryPublishForStudent">
		<id column="ID" jdbcType="INTEGER" property="id" />
		<result column="NAME" jdbcType="VARCHAR" property="name" />
		<result column="SCORE" jdbcType="INTEGER" property="score" />
		<result column="COST" jdbcType="BIGINT" property="cost" />
	</resultMap>
	<select id="findPublishForTeacher" resultMap="ForTeacherMap">
		select
			p.id,l.name,c.name,p.average
		from
			library_publish p,library l,class c 
		where 
			p.lid=l.id and p.cid=c.id and p.creator=#{creator}
		order by p.create_date desc
	</select>
	<select id="findPublishForStudent" resultMap="ForStudentMap">
		select 
			r.id,l.name,r.score,r.cost
		from 
			library_publish p,library l,library_record r
		where 
			p.lid=l.id and p.id=r.pid and p.type=#{type} and r.creator=#{creator} 
		order by p.create_date desc
	</select>
</mapper>